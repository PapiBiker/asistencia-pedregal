(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))m(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const s of d.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&m(s)}).observe(document,{childList:!0,subtree:!0});function o(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function m(l){if(l.ep)return;l.ep=!0;const d=o(l);fetch(l.href,d)}})();const K="modulepreload",Z=function(t){return"/asistencia-pedregal/"+t},k={},G=function(e,o,m){let l=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),w=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));l=Promise.allSettled(o.map(i=>{if(i=Z(i),i in k)return;k[i]=!0;const c=i.endsWith(".css"),p=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${p}`))return;const n=document.createElement("link");if(n.rel=c?"stylesheet":K,c||(n.as="script"),n.crossOrigin="",n.href=i,w&&n.setAttribute("nonce",w),document.head.appendChild(n),c)return new Promise((r,f)=>{n.addEventListener("load",r),n.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})}))}function d(s){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=s,window.dispatchEvent(w),!w.defaultPrevented)throw s}return l.then(s=>{for(const w of s||[])w.status==="rejected"&&d(w.reason);return e().catch(d)})};function q(t={}){const{immediate:e=!1,onNeedRefresh:o,onOfflineReady:m,onRegistered:l,onRegisteredSW:d,onRegisterError:s}=t;let w,i;const c=async(n=!0)=>{await i};async function p(){if("serviceWorker"in navigator){if(w=await G(async()=>{const{Workbox:n}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:n}},[]).then(({Workbox:n})=>new n("/asistencia-pedregal/sw.js",{scope:"/asistencia-pedregal/",type:"classic"})).catch(n=>{s==null||s(n)}),!w)return;w.addEventListener("activated",n=>{(n.isUpdate||n.isExternal)&&window.location.reload()}),w.addEventListener("installed",n=>{n.isUpdate||m==null||m()}),w.register({immediate:e}).then(n=>{d?d("/asistencia-pedregal/sw.js",n):l==null||l(n)}).catch(n=>{s==null||s(n)})}}return i=p(),c}const D=(t,e)=>e.some(o=>t instanceof o);let U,z;function X(){return U||(U=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Y(){return z||(z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j=new WeakMap,L=new WeakMap,A=new WeakMap;function ee(t){const e=new Promise((o,m)=>{const l=()=>{t.removeEventListener("success",d),t.removeEventListener("error",s)},d=()=>{o($(t.result)),l()},s=()=>{m(t.error),l()};t.addEventListener("success",d),t.addEventListener("error",s)});return A.set(e,t),e}function te(t){if(j.has(t))return;const e=new Promise((o,m)=>{const l=()=>{t.removeEventListener("complete",d),t.removeEventListener("error",s),t.removeEventListener("abort",s)},d=()=>{o(),l()},s=()=>{m(t.error||new DOMException("AbortError","AbortError")),l()};t.addEventListener("complete",d),t.addEventListener("error",s),t.addEventListener("abort",s)});j.set(t,e)}let O={get(t,e,o){if(t instanceof IDBTransaction){if(e==="done")return j.get(t);if(e==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return $(t[e])},set(t,e,o){return t[e]=o,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _(t){O=t(O)}function re(t){return Y().includes(t)?function(...e){return t.apply(N(this),e),$(this.request)}:function(...e){return $(t.apply(N(this),e))}}function oe(t){return typeof t=="function"?re(t):(t instanceof IDBTransaction&&te(t),D(t,X())?new Proxy(t,O):t)}function $(t){if(t instanceof IDBRequest)return ee(t);if(L.has(t))return L.get(t);const e=oe(t);return e!==t&&(L.set(t,e),A.set(e,t)),e}const N=t=>A.get(t);function ne(t,e,{blocked:o,upgrade:m,blocking:l,terminated:d}={}){const s=indexedDB.open(t,e),w=$(s);return m&&s.addEventListener("upgradeneeded",i=>{m($(s.result),i.oldVersion,i.newVersion,$(s.transaction),i)}),o&&s.addEventListener("blocked",i=>o(i.oldVersion,i.newVersion,i)),w.then(i=>{d&&i.addEventListener("close",()=>d()),l&&i.addEventListener("versionchange",c=>l(c.oldVersion,c.newVersion,c))}).catch(()=>{}),w}const ie=["get","getKey","getAll","getAllKeys","count"],ae=["put","add","delete","clear"],P=new Map;function V(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P.get(e))return P.get(e);const o=e.replace(/FromIndex$/,""),m=e!==o,l=ae.includes(o);if(!(o in(m?IDBIndex:IDBObjectStore).prototype)||!(l||ie.includes(o)))return;const d=async function(s,...w){const i=this.transaction(s,l?"readwrite":"readonly");let c=i.store;return m&&(c=c.index(w.shift())),(await Promise.all([c[o](...w),l&&i.done]))[0]};return P.set(e,d),d}_(t=>({...t,get:(e,o,m)=>V(e,o)||t.get(e,o,m),has:(e,o)=>!!V(e,o)||t.has(e,o)}));const se=["continue","continuePrimaryKey","advance"],H={},M=new WeakMap,F=new WeakMap,ce={get(t,e){if(!se.includes(e))return t[e];let o=H[e];return o||(o=H[e]=function(...m){M.set(this,F.get(this)[e](...m))}),o}};async function*le(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const o=new Proxy(e,ce);for(F.set(o,e),A.set(o,N(e));e;)yield o,e=await(M.get(o)||e.continue()),M.delete(o)}function R(t,e){return e===Symbol.asyncIterator&&D(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&D(t,[IDBIndex,IDBObjectStore])}_(t=>({...t,get(e,o,m){return R(e,o)?le:t.get(e,o,m)},has(e,o){return R(e,o)||t.has(e,o)}}));const E="https://asistencia-backend-production-53df.up.railway.app",b="/asistencia-pedregal/";q({onNeedRefresh(){console.log("ðŸ”„ Nueva versiÃ³n disponible. Recarga para actualizar.")},onOfflineReady(){console.log("âœ… App lista para trabajar sin conexiÃ³n.")}});window.addEventListener("online",()=>{console.log("ðŸŒ ConexiÃ³n restaurada")});window.addEventListener("offline",()=>{console.log("ðŸ“´ Sin conexiÃ³n")});const ue=async()=>{const t=await ne("asiscamp-db",1,{upgrade(m){m.objectStoreNames.contains("usuarios")||m.createObjectStore("usuarios",{keyPath:"id"})}}),e=localStorage.getItem("nombre"),o=localStorage.getItem("usuario_id");e&&o&&await t.put("usuarios",{id:parseInt(o),nombre:e,rol:localStorage.getItem("perfil")})};ue();q({onNeedRefresh(){console.log("ðŸ”„ Nueva versiÃ³n disponible. Recarga para actualizar.")},onOfflineReady(){console.log("âœ… La app estÃ¡ lista para funcionar offline.")}});document.addEventListener("DOMContentLoaded",()=>{var w;const t=window.location.pathname,e=localStorage.getItem("token"),o=localStorage.getItem("usuario_id"),m=(w=localStorage.getItem("perfil"))==null?void 0:w.toLowerCase();if(!window.location.pathname.endsWith(`${b}index.html`)&&window.location.pathname!==b&&(l("#header",`${b}src/components/header.html`),l("#footer",`${b}src/components/footer.html`)),!t.endsWith(`${b}index.html`)&&t!==b&&(!e||!o||!m)){alert("SesiÃ³n expirada o invÃ¡lida. Inicia sesiÃ³n."),window.location.href=b;return}if(t.includes(`${b}/admin`)){if(m!=="admin"){const r=document.getElementById("iniciomenu");r&&(r.style.display="none"),alert("Acceso solo para administradores"),window.location.href=`${b}asistencia`;return}const i=document.getElementById("addUserBtn");i&&i.addEventListener("click",p),c(),n();async function c(){try{const f=await(await fetch(`${E}/users`,{headers:{Authorization:`Bearer ${e}`}})).json(),a=document.querySelector("#usuariosTable tbody");a.innerHTML="",f.forEach(u=>{const v=document.createElement("tr");v.innerHTML=`
            <td>${u.id}</td>
            <td>${u.nombre}</td>
            <td>${u.perfil}</td>
            <td>${u.usuario}</td>
            <td>${u.estado}</td>
            <td class="text-center">
              <button class="btn btn-outline-secondary" onclick="editUser(${u.id}, '${u.nombre}', '${u.perfil}', '${u.usuario}' )">Editar</button>
              <button class="btn btn-outline-primary" onclick="desactivarUsuario(${u.id})">Desactivar</button>
              <button class="btn btn-outline-danger" onclick="deleteUser(${u.id})">Eliminar</button>
            </td>
          `,a.appendChild(v)})}catch(r){console.error("Error al cargar usuarios:",r)}}async function p(){const{value:r}=await Swal.fire({title:"Nuevo usuario",input:"text",inputPlaceholder:"Usuario del nuevo usuario",showCancelButton:!0,inputValidator:g=>{if(!g)return"Por favor ingresa un usuario"}});if(!r)return;const{value:f}=await Swal.fire({title:"Nuevo nombre",input:"text",inputPlaceholder:"Nombre del nuevo usuario",showCancelButton:!0,inputValidator:g=>{if(!g)return"Por favor ingresa un nombre"}});if(!f)return;const{value:a}=await Swal.fire({title:"Perfil",input:"text",inputPlaceholder:"Perfil (admin/usuario)",showCancelButton:!0,inputValidator:g=>{if(!g)return"Por favor ingresa un perfil"}});if(!a)return;const{value:u}=await Swal.fire({title:"Correo",input:"email",inputPlaceholder:"Correo del nuevo usuario",showCancelButton:!0,inputValidator:g=>{if(!g)return"Por favor ingresa un correo";if(!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(g))return"Correo no vÃ¡lido"}});if(!u)return;const{value:v}=await Swal.fire({title:"ContraseÃ±a",input:"password",inputPlaceholder:"ContraseÃ±a del nuevo usuario",showCancelButton:!0,inputValidator:g=>{if(!g)return"Por favor ingresa una contraseÃ±a"}});if(v)try{const g=await fetch(`${E}/users`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({usuario:r,nombre:f,perfil:a,correo:u,password:v})});if(g.ok)Swal.fire({title:"Â¡Usuario agregado!",text:"El usuario se ha agregado correctamente.",icon:"success",confirmButtonText:"Aceptar"}),c();else{const h=await g.json();Swal.fire({title:"Error",text:h.error||"No se pudo agregar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}}catch(g){console.error("Error:",g),Swal.fire({title:"Error",text:"Hubo un problema al agregar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}}window.editUser=async function(r,f,a,u,v){const{value:g}=await Swal.fire({title:"Nuevo nombre",input:"text",inputValue:f,showCancelButton:!0,inputValidator:y=>{if(!y)return"Por favor ingresa un nombre"}});if(!g)return;const{value:h}=await Swal.fire({title:"Nuevo perfil",input:"text",inputValue:a,showCancelButton:!0,inputValidator:y=>{if(!y)return"Por favor ingresa un perfil"}});if(!h)return;const{value:x}=await Swal.fire({title:"Nuevo usuario",input:"text",inputValue:u,showCancelButton:!0,inputValidator:y=>{if(!y)return"Por favor ingresa un nombre de usuario"}});if(!x)return;const{value:S}=await Swal.fire({title:"Estado del usuario",input:"select",inputOptions:{activo:"Activo",inactivo:"Inactivo"},inputValue:v||"activo",showCancelButton:!0,inputValidator:y=>{if(!y)return"Por favor selecciona un estado"}});if(S)try{const y=await fetch(`${E}/users/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({usuario:x,nombre:g,perfil:h,estado:S})});if(y.ok)Swal.fire({title:"Â¡Usuario actualizado!",text:"Los datos del usuario fueron actualizados con Ã©xito.",icon:"success",confirmButtonText:"Aceptar"}),c();else{const B=await y.json();Swal.fire({title:"Error",text:B.error||"No se pudo actualizar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}}catch(y){console.error("Error:",y),Swal.fire({title:"Error",text:"Hubo un problema al actualizar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}},window.desactivarUsuario=async function(r){if((await Swal.fire({title:"Â¿EstÃ¡s seguro?",text:"El usuario serÃ¡ desactivado y no podrÃ¡ acceder al sistema.",icon:"warning",showCancelButton:!0,confirmButtonText:"SÃ­, desactivar",cancelButtonText:"Cancelar"})).isConfirmed)try{const a=await fetch(`${E}/users/desactivar/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(a.ok)Swal.fire({title:"Â¡Usuario desactivado!",text:"El usuario fue desactivado correctamente.",icon:"success",confirmButtonText:"Aceptar"}),c();else{const u=await a.json();Swal.fire({title:"Error",text:u.error||"No se pudo desactivar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}}catch(a){console.error("Error:",a),Swal.fire({title:"Error",text:"Hubo un problema al desactivar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}},window.deleteUser=async function(r){if((await Swal.fire({title:"Â¿EstÃ¡s seguro?",text:"Esta acciÃ³n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#d33",cancelButtonColor:"#aaa"})).isConfirmed)try{(await fetch(`${E}/users/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})).ok?(Swal.fire({title:"Â¡Usuario eliminado!",text:"El usuario fue eliminado con Ã©xito.",icon:"success",confirmButtonText:"Aceptar"}),c()):Swal.fire({title:"Error",text:"No se pudo eliminar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}catch(a){console.error("Error:",a),Swal.fire({title:"Error",text:"Hubo un problema al eliminar el usuario.",icon:"error",confirmButtonText:"Aceptar"})}};async function n(){try{const f=await(await fetch(`${E}/asistencia`,{headers:{Authorization:`Bearer ${e}`}})).json(),a=document.querySelector("#asistenciasTable tbody");a.innerHTML="",f.forEach(u=>{const v=document.createElement("tr");v.innerHTML=`
          <td>${u.fecha}</td>  
          <td>${u.hora}</td>
          <td>${u.registrador}</td>
          <td>${u.nombre}</td>
          <td>${u.labor}</td>
          <td>${u.lote}</td>
          <td>${u.turno}</td>

            <td>
              <button class="btn btn-outline-danger" onclick="deleteAsistencia(${u.id})">Eliminar</button>
            </td>
          `,a.appendChild(v)})}catch(r){console.error("Error al cargar asistencias:",r)}}window.deleteAsistencia=async function(r){if((await Swal.fire({title:"Â¿EstÃ¡s seguro?",text:"Esta acciÃ³n no se puede deshacer.",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#d33",cancelButtonColor:"#aaa"})).isConfirmed)try{(await fetch(`${E}/asistencia/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})).ok?(Swal.fire({title:"Â¡Eliminado!",text:"El registro de asistencia fue eliminado con Ã©xito.",icon:"success",confirmButtonText:"Aceptar"}),n()):Swal.fire({title:"Error",text:"No se pudo eliminar el registro de asistencia.",icon:"error",confirmButtonText:"Aceptar"})}catch(a){console.error("Error:",a),Swal.fire({title:"Error",text:"Hubo un problema al eliminar la asistencia.",icon:"error",confirmButtonText:"Aceptar"})}}}if((t.includes("salir")||t==="/salir")&&(localStorage.clear(),window.location.href=b),t.includes(`${b}index.html`)||t===b){const i=document.getElementById("loginForm");i&&i.addEventListener("submit",async c=>{c.preventDefault();const p=document.getElementById("usuario").value.trim(),n=document.getElementById("password").value.trim(),r=document.getElementById("errorMessage");if(!p||!n){r.innerText="Completa todos los campos.";return}try{const f=await fetch(`${b}auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:p,password:n})});if(f.ok){const a=await f.json();localStorage.setItem("token",a.token),localStorage.setItem("usuario_id",a.id),localStorage.setItem("perfil",a.rol),localStorage.setItem("nombre",a.nombre),a.rol.toLowerCase()==="admin"?window.location.href=`${b}admin`:window.location.href=`${b}asistencia`}else{const a=await f.json();r.innerText=a.error||"Error de login."}}catch(f){console.error("Error en login:",f),r.innerText="Error en la conexiÃ³n."}})}if(t.includes("asistencia.html")||t==="/asistencia"){let i=function(){r&&(r.pause(),r.srcObject=null)},c=function(){if(r.readyState===r.HAVE_ENOUGH_DATA){const h=document.createElement("canvas");h.width=r.videoWidth,h.height=r.videoHeight;const x=h.getContext("2d");x.drawImage(r,0,0,h.width,h.height);const S=x.getImageData(0,0,h.width,h.height),y=jsQR(S.data,h.width,h.height);if(y){const B=y.data,C=document.getElementById("dniInput");C&&(C.value=B),g(B,o).finally(()=>{requestAnimationFrame(c)})}else requestAnimationFrame(c)}else requestAnimationFrame(c)},p=function(){new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg").play().catch(console.error)};const n=document.getElementById("dniInput"),r=document.getElementById("qrScanner");document.getElementById("result");const f=document.getElementById("errorMessage");if(d(),s(),!o){alert("Usuario no identificado."),window.location.href=b;return}n.addEventListener("input",async()=>{const h=n.value.trim();h.length===8&&/^\d{8}$/.test(h)&&(n.value="",Swal.fire({title:"Registrando...",text:"Por favor espera",allowOutsideClick:!1,didOpen:()=>{Swal.showLoading()}}),await g(h,o))});const a=document.getElementById("initQRSCanH");let u=!1;a&&a.addEventListener("click",()=>{u?(i(),a.innerText="Iniciar Lectura",a.classList.replace("btn-danger","btn-success"),u=!1):(v(),a.innerText="Terminar Lectura",a.classList.replace("btn-success","btn-danger"),u=!0)});async function v(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{const h=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});r.srcObject=h,r.setAttribute("playsinline",!0),r.play(),requestAnimationFrame(c)}catch{f.innerText="No se pudo acceder a la cÃ¡mara.",n&&(n.disabled=!0)}else f.innerText="Tu navegador no soporta cÃ¡mara.",n&&(n.disabled=!0)}async function g(h,x){const S=document.querySelector("#loadLabor").value,y=document.querySelector("#loadLote").value,B=document.querySelector("#setturno").value;if(!S)throw new Error("Labor o lote no seleccionados.");if(!y)throw new Error("Lote no seleccionados.");if(!B)throw new Error("Turno no seleccionados.");const C={dni:h,usuario_id:x,labor:S,lote:y,turno:B};try{const T=await fetch(`${E}/asistencia/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(C)});if(console.log("CÃ³digo de estado HTTP:",T.status),T.ok){Swal.close(),p(),Swal.fire({title:"âœ… Registrado",text:"Asistencia registrada correctamente.",icon:"success",timer:2e3,showConfirmButton:!1});const I=await T.json(),W=new Date(`${I.fecha}T${I.hora}Z`),Q=new Intl.DateTimeFormat("es-PE",{timeZone:"America/Lima",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(W);document.getElementById("nombre").innerText=`âœ… ${I.nombre}`,document.getElementById("fechaHora").innerText=`ðŸ—“ï¸ ${Q}`,f.innerText="",p(),await new Promise(J=>setTimeout(J,3e3))}else{const I=await T.json();f.innerText=I.error||"Error al registrar asistencia.",Swal.fire({title:"âŒ Error",text:I.error||"No se pudo registrar la asistencia.",icon:"error",confirmButtonText:"Aceptar"})}}catch(T){console.error(T),f.innerText="Error en la conexiÃ³n.",Swal.fire({title:"âŒ Error",text:"Error en la conexiÃ³n.",icon:"error",confirmButtonText:"Aceptar"})}}}function l(i,c){const p=document.querySelector(i);p?fetch(c).then(n=>n.text()).then(n=>{p.innerHTML=n}).catch(n=>console.error("Error loading component:",n)):console.error(`Element with selector ${i} not found.`)}if(t.includes("productividad")||t==="/productividad"){i();async function i(){try{const p=await(await fetch(`${E}/productividad?usuario_id=${o}`,{headers:{Authorization:`Bearer ${e}`}})).json(),n=document.querySelector("#asistenciasTable tbody");n.innerHTML="",p.forEach(r=>{const f=document.createElement("tr");f.innerHTML=`
          <td>${r.fecha}</td>  
          <td>${r.hora}</td>
          <td>${r.nombre}</td>
          <td>${r.labor}</td>
          <td>${r.lote}</td>
          <td><input type="number" value="${r.avance}" class="form-control" id="avance-${r.id}" data-id="${r.id}" min="0"></td>
          <td><input type="number" value="${r.productividad}" class="form-control" id="productividad-${r.id}" data-id="${r.id}" min="0"></td>
          <td>
            <button class="btn btn-outline-success" data-id="${r.id}" onclick="actualizarRegistro(${r.id})">Actualizar</button>
          </td>
        `,n.appendChild(f)})}catch(c){console.error("Error al cargar asistencias:",c)}}window.actualizarRegistro=async function(c){const p=document.querySelector(`#avance-${c}`),n=document.querySelector(`#productividad-${c}`),r=parseFloat(p.value)||0,f=parseFloat(n.value)||0;try{const a=await fetch(`${E}/productividad/${c}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({avance:r,productividad:f})}),u=await a.json();a.ok?Swal.fire({icon:"success",title:"Â¡Actualizado!",text:u.message,timer:2e3,showConfirmButton:!1}):Swal.fire({icon:"error",title:"Error al actualizar",text:u.error||"OcurriÃ³ un error inesperad o"})}catch(a){Swal.fire({icon:"error",title:"Error de red",text:a.message||"No se pudo conectar al servidor"})}}}async function d(){try{const c=await(await fetch(`${E}/labor`,{headers:{Authorization:`Bearer ${e}`}})).json(),p=document.querySelector("#loadLabor");p.innerHTML="<option selected disabled>Selecciona una labor</option>",c.forEach(n=>{const r=document.createElement("option");r.value=n.id,r.textContent=n.description,p.appendChild(r)}),p.tomselect||new TomSelect(p,{placeholder:"Buscar labor...",allowEmptyOption:!0})}catch(i){console.error("Error al cargar labores:",i)}}async function s(){try{const c=await(await fetch(`${E}/lote`,{headers:{Authorization:`Bearer ${e}`}})).json(),p=document.querySelector("#loadLote");p.innerHTML="<option selected disabled>Selecciona un lote</option>",c.forEach(n=>{const r=document.createElement("option");r.value=n.id,r.textContent=n.id,p.appendChild(r)})}catch(i){console.error("Error al cargar lotes:",i)}}});
